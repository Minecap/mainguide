#include <iostream>
#include <string>
#include <algorithm>
#include <fstream>
#include <ctime>
#include <cstdlib>
#include <windows.h>

void showHelp() {
    std::cout << "=== 명령어 목록 ===" << std::endl;
    std::cout << "help    - 명령어 목록 표시" << std::endl;
    std::cout << "hello   - 'Hello, World!' 출력" << std::endl;
    std::cout << "time    - 현재 시스템 시간 출력" << std::endl;
    std::cout << "list    - 현재 디렉토리의 파일 목록 출력" << std::endl;
    std::cout << "create  - 새로운 텍스트 파일 생성" << std::endl;
    std::cout << "random  - 1에서 100 사이의 랜덤 숫자 출력" << std::endl;
    std::cout << "open    - 입력한 웹사이트 열기 (URL 변환 포함)" << std::endl;
    std::cout << "exit    - 프로그램 종료" << std::endl;
}

void showTime() {
    std::time_t now = std::time(nullptr);
    char buffer[26];
    errno_t err = ctime_s(buffer, sizeof(buffer), &now);
    if (err == 0) {
        std::cout << "현재 시간: " << buffer;
    }
    else {
        std::cerr << "시간을 가져오는 데 실패했습니다." << std::endl;
    }
}

void listFiles() {
    std::cout << "현재 디렉토리의 파일 목록을 표시합니다..." << std::endl;
    system("dir");
}

void createFile() {
    std::string fileName;
    std::cout << "생성할 파일 이름을 입력하세요: ";
    std::getline(std::cin, fileName);
    std::ofstream file(fileName);
    if (file.is_open()) {
        std::cout << fileName << " 파일이 생성되었습니다." << std::endl;
        file.close();
    }
    else {
        std::cout << "파일 생성에 실패했습니다." << std::endl;
    }
}

void generateRandomNumber() {
    srand(static_cast<unsigned>(time(0)));
    int randomNum = rand() % 100 + 1;
    std::cout << "생성된 랜덤 숫자: " << randomNum << std::endl;
}

void openWebsite() {
    std::string url;
    std::cout << "열고 싶은 웹사이트 주소를 입력하세요 (예: keyonair.com): ";
    std::getline(std::cin, url);
    if (url.find(".com") != std::string::npos) {
        url.replace(url.find(".com"), 4, ".kr");
    }
    else if (url.find(".kr") != std::string::npos) {
        url.replace(url.find(".kr"), 3, ".com");
    }
    std::cout << "웹사이트로 연결 중: " << url << std::endl;
    std::string command = "start " + url;
    system(command.c_str());
}

void handleCommand(const std::string& command) {
    if (command == "help") {
        showHelp();
    }
    else if (command == "hello") {
        std::cout << "Hello, World!" << std::endl;
    }
    else if (command == "time") {
        showTime();
    }
    else if (command == "list") {
        listFiles();
    }
    else if (command == "create") {
        createFile();
    }
    else if (command == "random") {
        generateRandomNumber();
    }
    else if (command == "open") {
        openWebsite();
    }
    else if (command == "exit") {
        std::cout << "프로그램을 종료합니다." << std::endl;
        exit(0);
    }
    else {
        std::cout << "알 수 없는 명령어입니다. 'help'를 입력해보세요." << std::endl;
    }
}

int main() {
    std::string command;
    std::cout << " " << std::endl;
    std::cout << "==<< 명령어 도우미 >>==" << std::endl;
    std::cout << "명령어를 입력하세요. ('help'를 입력해 도움말 확인 가능)" << std::endl;
    std::cout << "사용법에 대해서 알아보시려면, '사용법'이라고 검색하여 주십시오." << std::endl;
    std::cout << "Made by Seo min seok. 2025 version '1.0' " << std::endl;
    std::cout << "초기 버전이며, 버그가 날수도 있습니다. " << std::endl;
    std::cout << " " << std::endl;
    while (true) {
        std::cout << "> ";
        std::getline(std::cin, command);
        std::transform(command.begin(), command.end(), command.begin(), ::tolower);
        handleCommand(command);
    }
    return 0;
}
